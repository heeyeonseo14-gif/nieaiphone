<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>NIEaiphone · 聊天</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:transparent;
  color:#2f2436;
}

/* ===== 背景层 ===== */
#bgLayer{
  position:fixed;
  inset:0;
  background:linear-gradient(180deg,#f5edff,#efe7fb);
  background-size:cover;
  background-position:center;
  z-index:-1;
  filter: brightness(1) blur(0px);
  transition: filter .2s;
}

/* ===== App ===== */
.app{
  max-width:430px;
  margin:0 auto;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  backdrop-filter: blur(12px);
}

/* ===== Header ===== */
.header{
  padding:14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.header h1{margin:0;font-size:18px}
.iconBtn{
  padding:6px 12px;
  border-radius:12px;
  border:none;
  background:white;
  font-weight:600;
}

/* ===== 联系人 ===== */
.contacts{flex:1;padding:12px}
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
}
.card{
  background:rgba(255,255,255,.75);
  backdrop-filter: blur(10px);
  border-radius:16px;
  padding:12px 8px;
  text-align:center;
}
.card img{
  width:56px;height:56px;border-radius:14px;object-fit:cover
}

/* ===== 底部 ===== */
.bottom{padding:12px}
.bottom button{
  width:100%;
  padding:10px;
  border-radius:999px;
  border:none;
  background:linear-gradient(135deg,#9b8cff,#7c68e6);
  color:white;
  font-weight:600;
}

/* ===== 弹窗通用 ===== */
.modalMask{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  backdrop-filter: blur(2px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:99;
}
.modal{
  background:rgba(255,255,255,.9);
  width:90%;
  max-width:360px;
  border-radius:20px;
  padding:18px;
}
.modal h3{text-align:center;margin:0 0 14px}

/* ===== 背景设置 ===== */
.settingRow{margin-bottom:14px}
.settingRow label{font-size:14px;display:block;margin-bottom:6px}
.settingRow input{width:100%}
</style>
</head>

<body>

<div id="bgLayer"></div>

<div class="app">

  <div class="header">
    <button class="iconBtn" onclick="location.href='home.html'">←</button>
    <h1>聊天</h1>
    <button class="iconBtn" onclick="openBg()">自定义</button>
  </div>

  <div class="contacts">
    <div class="grid">
      <div class="card">
        <img src="https://placekitten.com/200/200">
        <div>测试</div>
      </div>
    </div>
  </div>

  <div class="bottom">
    <button>朋友圈</button>
  </div>
</div>

<!-- 背景设置弹窗 -->
<div class="modalMask" id="bgModal">
  <div class="modal">
    <h3>背景设置</h3>

    <button class="iconBtn" onclick="pickBg()">选择背景图</button>

    <div class="settingRow">
      <label>亮度</label>
      <input type="range" min="0.6" max="1.4" step="0.05" id="bright">
    </div>

    <div class="settingRow">
      <label>模糊</label>
      <input type="range" min="0" max="12" step="1" id="blur">
    </div>

    <button class="iconBtn" onclick="closeBg()">关闭</button>
  </div>
</div>

<input type="file" id="bgPicker" accept="image/*" hidden>

<script>
const bg=document.getElementById('bgLayer');
const bright=document.getElementById('bright');
const blur=document.getElementById('blur');

/* 初始化 */
const img=localStorage.getItem('bg_img');
if(img) bg.style.backgroundImage=`url(${img})`;

bright.value=localStorage.getItem('bg_bright')||1;
blur.value=localStorage.getItem('bg_blur')||0;
applyFilter();

/* 打开关闭 */
function openBg(){bgModal.style.display='flex'}
function closeBg(){bgModal.style.display='none'}

/* 选择背景 */
function pickBg(){bgPicker.click()}
bgPicker.onchange=e=>{
  const f=e.target.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=()=>{
    localStorage.setItem('bg_img',r.result);
    bg.style.backgroundImage=`url(${r.result})`;
  };
  r.readAsDataURL(f);
};

/* 滑杆 */
bright.oninput=()=>{localStorage.setItem('bg_bright',bright.value);applyFilter()}
blur.oninput=()=>{localStorage.setItem('bg_blur',blur.value);applyFilter()}

function applyFilter(){
  bg.style.filter=`brightness(${bright.value}) blur(${blur.value}px)`;
}
</script>

</body>
</html>
